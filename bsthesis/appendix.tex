%!TEX root = thesis.tex

%% ==============================
%\chapter{Appendix}
%\label{ch:Appendix}
%% ==============================

\appendix

\iflanguage{english}
{\addchap{Appendix}}	% english style
{\addchap{Anhang}}	% german style

\section{Algorithms}\label{appendix:algorithms}
\begin{algorithm}[ht]
  \begin{algorithmic}
        \Function{dehook\_line}{$line$, $\theta \in \mathbb{R}_{\geq 0}$}
            \If{$\Call{count}{line} < 3$}
                \State \Return $line$
            \Else
                \State $new\_line \gets line[0: \Call{count}{line}-1]$ \Comment{Get everything but the last point}
                \State $line \gets line[\Call{count}{line}-3:]$ \Comment{get the last 3 points}
                \State $p \gets line[-1]$ \Comment{last point}
                \If{$\Call{calculate\_angle}{line} < \theta$}
                    \State $new\_line.\Call{append}{p}$
                \Else
                    \State $new\_line \gets \Call{dehook\_line}{new\_line, \theta}$
                \EndIf
            \EndIf
            \Return $new\_pointlist$
        \EndFunction
  \end{algorithmic}
  \caption{Dehooking}
  \label{alg:dehooking}
\end{algorithm}

\begin{algorithm}[ht]
  \begin{algorithmic}
        \Function{dot\_reduction}{$pointlist$, $\theta \in \mathbb{R}_{\geq 0}$}
            \State $new\_pointlist \gets []$
            \State $current\_line \gets 0$
            \ForAll{$line$ in $pointlist$}
                \State $new\_line \gets line$
                \State $max\_distance = \Call{get\_max\_distance}{line}$

                \If{$max\_distance < \theta$}
                    \State $new\_line \gets [\Call{get\_average\_point}{line}]$
                \EndIf
                \State $new\_pointlist.\Call{append}{new\_line}$
            \EndFor
            \Return $new\_pointlist$
        \EndFunction
  \end{algorithmic}
  \caption{Dot reduction}
  \label{alg:dot-reduction}
\end{algorithm}


\begin{algorithm}[ht]
  \begin{algorithmic}
        \Function{weighted\_average\_smoothing}{$pointlist$, $\theta = [\frac{1}{6}, \frac{4}{6}, \frac{1}{6}]$}
            \State $\theta \gets \frac{1}{\Call{sum}{\theta}} \cdot \theta$ \Comment{Normalize parameters to a sum of 1}
            \State $new\_pointlist \gets []$
            \State $current\_line \gets 0$
            \ForAll{$line$ in $pointlist$}
                \State $new\_pointlist.\Call{append}{[line[0]]}$
                \If{$\Call{length}{line} > 1$}
                    \For{$i \gets 1; i < \Call{length}{line}-1; i \gets i + 1$}
                        \State $p \gets \theta_0 \cdot line[i-1] + \theta_1 \cdot line[i] + \theta_2 \cdot line[i+1]$
                        \State $new\_pointlist[current\_line].\Call{append}{p}$
                    \EndFor
                    \State $new\_pointlist[current\_line].\Call{append}{line[-1]}$
                \EndIf
                \State $current\_line \gets current\_line + 1$
            \EndFor
            \Return $new\_pointlist$
        \EndFunction
  \end{algorithmic}
  \caption{Weighted average smoothing}
  \label{alg:weighted-average-smoothing}
\end{algorithm}

\begin{algorithm}[ht]
  \begin{algorithmic}
    \State $a \gets \text{next from}~A$
    \State $b \gets \text{next from}~B$
    \State $d \gets \delta(a,b)$
    \State $a' \gets \text{next from}~A$
    \State $b' \gets \text{next from}~B$
    \While{points left in $A$ $\wedge$ points left in $B$}
      \State $l, m, r \gets \delta(a',b), \delta(a', b'), \delta(a, b')$
      \State $\mu \gets \min ~\{l, m, r\}$
      %\COMMENT{ Important line }
      \State $d \gets d + \mu$
      \If{$l = \mu$}
        \State $a \gets a'$
        \State $a' \gets \text{next from}~A$
      \ElsIf{$r = \mu$}
        \State $b \gets b'$
        \State $b' \gets \text{next from}~B$
      \Else
        \State $a \gets a'$
        \State $b \gets b'$
        \State $a' \gets \text{next from}~A$
        \State $b' \gets \text{next from}~B$
      \EndIf
    \EndWhile
    \If{no points left in $A$}
      \ForAll{points $p$ in $B$}
        \State $d \gets d + \delta(a',p)$
      \EndFor
    \ElsIf{no points left in $B$}
      \ForAll{points $p$ in $A$}
        \State $d \gets d + \delta(b',p)$
      \EndFor
    \EndIf
  \end{algorithmic}
  \caption{Greedy matching as described in \cite{Kirsch}}
  \label{alg:greedy-matching}
\end{algorithm}

\begin{algorithm}[ht]
    \begin{algorithmic}
        \Function{scale\_and\_shift}{$pointlist$}
            \State $min_x, min_y = pointlist[0]['x'], pointlist[0]['y']$
            \State $max_x, max_y = pointlist[0]['x'], pointlist[0]['y']$
            \ForAll{$lines$ in $pointlist$}
                \ForAll{$p$ in $lines$}
                    \If{$p['x'] < min_x$}
                        \State $min_x \gets p['x']$
                    \ElsIf{$p['x'] > max_x$}
                        \State $max_x \gets p['x']$
                    \EndIf

                    \If{$p['y'] < min_y$}
                        \State $min_y \gets p['y']$
                    \ElsIf{$p['y'] > max_y$}
                        \State $max_y \gets p['y']$
                    \EndIf
                \EndFor
            \EndFor

            \State $width, height \gets max_x - min_x, max_y - min_y$

            \State $factor = 1$

            \If{$width \neq 0$}
                \State $factor_x = \frac{1}{width}$
            \EndIf

            \If{$height \neq 0$}
                \State $factor_y = \frac{1}{height}$
            \EndIf

            \State $factor = \min(factor_x, factor_y)$
            \State $add_x, add_y = 0, 0$

            \ForAll{$lines$ in $pointlist$}
                \ForAll{$p$ in $lines$}
                    \State $p['x'] \gets (p["x"] - minx) \cdot factor$
                    \State $p['y'] \gets (p["y"] - miny) \cdot factor$
                \EndFor
            \EndFor

            \Return $pointlist$
        \EndFunction
    \end{algorithmic}
\caption{Scale and shift a list of lines to the $(0,1) \times (0, 1)$ unit square}
\label{alg:scale-and-shift}
\end{algorithm}
% \clearpage
% \section{Figures}\label{appendix:figures}
% \setcounter{figure}{0}
% % TODO
% \begin{figure} [ht]
%     \centering
%     ein Bild
%     \caption{A figure}
%     \label{fig:BPMNBeispiela}
% \end{figure}
