{% extends "base.twig" %}

{% block header %}
<script type='text/javascript' src='http://cdnjs.cloudflare.com/ajax/libs/fabric.js/1.4.0/fabric.min.js'></script>

 <script type='text/javascript'>
     window.onload=function(){
 {% for image in userimages %}
    var canvas = new fabric.Canvas('galleryImage{{ loop.index }}');
    var group = new fabric.Group();
    canvas.add(group);

    var path = new fabric.Path('{{ image.path}}');
    path.set({fill: 'transparent', stroke: 'red', strokeWidth: 3});
    path.scale(Math.min(canvas.height / path.height, 
                                canvas.width  / path.width));
    canvas.add(path);
    canvas.renderAll();
    path.center();
    /* Make sure that touch events do nothing */
    canvas.deactivateAll();
    canvas.selection = false;
    canvas.forEachObject(function(o) {
        o.selectable = false;
    });
 {% endfor %}
}
 </script>
{% endblock %}

{% block content %}
	<ul class="nav nav-tabs">
	  <li {% if tab == 'my_raw_data' %}class="active"{% endif %}><a href="../gallery">My raw data</a></li>
	  <li {% if tab == 'unclassified' %}class="active"{% endif %}><a href="../gallery?tab=unclassified">Unclassified</a></li>
	  <li {% if tab == 'all' %}class="active"{% endif %}><a href="../gallery?tab=all">All raw data</a></li>
	</ul>

   <ul class="gallery mw-gallery-traditional">
    {% for image in userimages %}
     <li class="gallerybox" style="width: 155px">
       <div style="width: 155px">
         <div class="thumb" style="width: 150px;">
           <div style="margin:21px auto;">
             <a href="../view?raw_data_id={{ image.id }}"><!--<canvas id="galleryImage{{ loop.index }}" class="gallerycanvas" width="140" height="140"></canvas>--><img src="../raw-data/{{ image.id }}.svg" style="width:140px;height:140px;"/></a>
           </div>
         </div>
         <div class="gallerytext"><a href="../view?raw_data_id={{ image.id }}">{{ image.creation_date }}</a></div>
       </div>
     </li>
    {% endfor %}
   </ul>

<ul class="pagination">
  {% if currentPage > 1 %}
      <li><a href="?page={{ currentPage-1 }}&tab={{ tab }}">&laquo;</a></li>
  {% else %}
      <li class="disabled"><a href="#">&laquo;</a></li>
  {% endif %}

  {% for i in 1..(pages+1) %}
    <li {% if i == currentPage %}class="active"{% endif %}><a href="?page={{ i }}&tab={{ tab }}">{{ i }}</a></li>
  {% endfor %}

  {% if currentPage < total %}
      <li><a href="?page={{ currentPage+1 }}&tab={{ tab }}">&raquo;</a></li>
  {% else %}
      <li class="disabled"><a href="#">&raquo;</a></li>
  {% endif %}
</ul>
{% endblock %}